---
title: "Report"
output: html_document
---

```{r, echo = FALSE, message = FALSE}
library(dplyr)
library(knitr)
library(ggplot2)

df <- read.csv("./data/report.data.csv", stringsAsFactors = FALSE)
df <- df[complete.cases(df[,33:41]),]

df$rape.rate7 <- as.numeric(df$rape.rate7)
df$rape.rate8 <- as.numeric(df$rape.rate8)
df$rape.rate9 <- as.numeric(df$rape.rate9)
df$rape.rate10 <- as.numeric(df$rape.rate10)
df$rape.rate11 <- as.numeric(df$rape.rate11)
df$rape.rate12 <- as.numeric(df$rape.rate12)
df$rape.rate13 <- as.numeric(df$rape.rate13)
df$rape.rate14 <- as.numeric(df$rape.rate14)
df$rape.rate15 <- as.numeric(df$rape.rate15)

medians <- c(median(df$rape.rate7),
           median(df$rape.rate8),
           median(df$rape.rate9), 
           median(df$rape.rate10),
           median(df$rape.rate11), 
           median(df$rape.rate12), 
           median(df$rape.rate13), 
           median(df$rape.rate14), 
           median(df$rape.rate15))
years <- c('2007', '2008', '2009', '2010', '2011', '2012', '2013', '2014', '2015')
medians.data <- as.data.frame(cbind(medians, years))

# adding mean graph
ggplot(data = medians.data, aes(
  x = years,
  y = medians,
  group = 1
)) + geom_line()

# getting the campuses with the most assault
maxes <- c(max(df$rape.rate7),
           max(df$rape.rate8),
           max(df$rape.rate9), 
           max(df$rape.rate10),
           max(df$rape.rate11), 
           max(df$rape.rate12), 
           max(df$rape.rate13), 
           max(df$rape.rate14), 
           max(df$rape.rate15)
)

max.data <- as.data.frame(cbind(maxes, years))

# adding table of maxes
kable(max.data, format = "markdown")

```


1. The rate of reported campus rape has been slowly increasing. However, because only an estimated 2% of rapes are reported, it's unclear whether this increase correlates to a genuine increase in rape cases or an increase in its reporting.
2. 
3. 